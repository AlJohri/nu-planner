<!DOCTYPE html><html lang="en"><head><title>app/controllers/utilities/Utilities</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../"><meta name="groc-document-path" content="app/controllers/utilities/Utilities"><meta name="groc-project-path" content="/Users/atul/Dropbox/Development/nu-planner/app/controllers/utilities/Utilities.java"><link rel="stylesheet" type="text/css" media="all" href="../../../assets/style.css"><script type="text/javascript" src="../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">/Users/atul/Dropbox/Development/nu-planner/app/controllers/utilities/Utilities.java</div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="kn">package</span> <span class="n">controllers</span><span class="o">.</span><span class="na">utilities</span><span class="o">;</span>

<span class="cm">/* General Java */</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.Charset</span><span class="o">;</span>

<span class="cm">/* Play Frameowork */</span>
<span class="kn">import</span> <span class="nn">play.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">play.mvc.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">play.data.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">play.db.ebean.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">models.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">views.html.*</span><span class="o">;</span>

<span class="cm">/* DateTime */</span>
<span class="kn">import</span> <span class="nn">org.joda.time.format.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.DateTime</span><span class="o">;</span>

<span class="cm">/* JSOUP and JSON */</span>
<span class="kn">import</span> <span class="nn">org.jsoup.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jsoup.Connection.Method</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jsoup.nodes.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jsoup.select.Elements</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.simple.JSONValue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.gson.*</span><span class="o">;</span>

<span class="cm">/* RestFB */</span>
<span class="kn">import</span> <span class="nn">com.restfb.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.restfb.FacebookClient.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.restfb.json.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.restfb.types.Event</span><span class="o">;</span>

<span class="cm">/* Facebook Constants */</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">controllers</span><span class="o">.</span><span class="na">facebook</span><span class="o">.</span><span class="na">Facebook</span><span class="o">.*;</span>

<span class="cm">/**</span>
<span class="cm"> * The Utilities class.</span>
<span class="cm">*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Utilities</span> <span class="kd">extends</span> <span class="n">Controller</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Integer</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Takes start time in string format as input</span>
<span class="cm">     * @return start time in DateTime format</span>
<span class="cm">    */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">DateTime</span> <span class="nf">parse_start_time</span><span class="o">(</span><span class="n">String</span> <span class="n">start</span><span class="o">)</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="o">(</span><span class="n">start</span><span class="o">!=</span><span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">start</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">start</span> <span class="o">!=</span> <span class="s">&quot;null&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">().</span><span class="na">parse</span><span class="o">(</span><span class="n">start</span><span class="o">)</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span> 
    <span class="o">}</span>
    <span class="cm">/**</span>
<span class="cm">     * Takes end time in string format as input</span>
<span class="cm">     * @return end time in DateTime format</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">DateTime</span> <span class="nf">parse_end_time</span><span class="o">(</span><span class="n">String</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="o">(</span><span class="n">end</span><span class="o">!=</span><span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">end</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">end</span> <span class="o">!=</span> <span class="s">&quot;null&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">().</span><span class="na">parse</span><span class="o">(</span><span class="n">end</span><span class="o">)</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span> 
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Many events have either a &quot;creator&quot; or an &quot;owner&quot; property depending on whether</span>
<span class="cm">     * they were scraped from FQL or Graph. The creator is just an id, however, the owner</span>
<span class="cm">     * is a json struct where the id is embedded inside.</span>
<span class="cm">     * This method normalizes the difference in the database by extracting the id from the</span>
<span class="cm">     * owner struct.</span>
<span class="cm">     * @param  event Event from which to extract owner/creator.</span>
<span class="cm">     * @return String creator/owner id</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getCreatorOrOwner</span><span class="o">(</span><span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">creator</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;owner&quot;</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">JSONObject</span> <span class="n">owner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;owner&quot;</span><span class="o">));</span>
                <span class="n">creator</span> <span class="o">=</span> <span class="n">owner</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">owner</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;creator&quot;</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">creator</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;creator&quot;</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">creator</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Many events have either a &quot;pic&quot; or an &quot;picture&quot; property depending on whether</span>
<span class="cm">     * they were scraped from FQL or Graph. The pic is just a url, however, the picture</span>
<span class="cm">     * is a json struct where the url is embedded inside.</span>
<span class="cm">     * This method normalizes the difference in the database by extracting the url from the</span>
<span class="cm">     * picture struct.</span>
<span class="cm">     * @param  event Event from which to extract pic/picture.</span>
<span class="cm">     * @return String pic/picture url</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getPicOrPicture</span><span class="o">(</span><span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">pic</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;picture&quot;</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">JSONObject</span> <span class="n">picture</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;picture&quot;</span><span class="o">));</span>
        <span class="n">String</span> <span class="n">dataString</span> <span class="o">=</span> <span class="n">picture</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;data&quot;</span><span class="o">);</span>
        <span class="n">JSONObject</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">dataString</span><span class="o">);</span>
        <span class="n">pic</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;url&quot;</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;pic&quot;</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">pic</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;pic&quot;</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">pic</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**</span>
<span class="cm">     * Input Event</span>
<span class="cm">     * Parse event to get all its properties as in MyEvent Constructor</span>
<span class="cm">     * @return MyEvent constructor </span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">MyEvent</span> <span class="nf">createEvent</span><span class="o">(</span><span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">String</span> <span class="n">str_eid</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;eid&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;eid&quot;</span><span class="o">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">);</span>
        <span class="n">Long</span> <span class="n">eid</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">str_eid</span><span class="o">).</span><span class="na">longValue</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">creator</span> <span class="o">=</span> <span class="n">getCreatorOrOwner</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
        <span class="n">DateTime</span> <span class="n">starttime</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;start_time&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">parse_start_time</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;start_time&quot;</span><span class="o">))</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span>
        <span class="n">DateTime</span> <span class="n">endtime</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;end_time&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">parse_end_time</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;end_time&quot;</span><span class="o">))</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">location</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;location&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;location&quot;</span><span class="o">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">venue</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;venue&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;venue&quot;</span><span class="o">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">description</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;description&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;description&quot;</span><span class="o">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>    
    <span class="n">String</span> <span class="n">pic</span> <span class="o">=</span> <span class="n">getPicOrPicture</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
    
    
        <span class="n">String</span> <span class="n">pic_small</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;pic_small&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;pic_small&quot;</span><span class="o">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">pic_big</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;pic_big&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;pic_big&quot;</span><span class="o">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">pic_square</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;pic_square&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">event</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;pic_square&quot;</span><span class="o">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
    

        <span class="k">if</span> <span class="o">(</span><span class="n">name</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;=</span><span class="mi">255</span> <span class="o">||</span> <span class="n">creator</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="mi">255</span> <span class="o">||</span> <span class="n">location</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="mi">255</span> <span class="o">||</span> <span class="n">venue</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="mi">255</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;error start&quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">creator</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">location</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">venue</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;error end&quot;</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">MyEvent</span><span class="o">(</span><span class="n">eid</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">creator</span><span class="o">,</span> <span class="n">starttime</span><span class="o">,</span> <span class="n">endtime</span><span class="o">,</span> <span class="n">location</span><span class="o">,</span> <span class="n">venue</span><span class="o">,</span> <span class="n">description</span><span class="o">,</span> <span class="n">pic</span><span class="o">,</span> <span class="n">pic_small</span><span class="o">,</span> <span class="n">pic_big</span><span class="o">,</span> <span class="n">pic_square</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Input event</span>
<span class="cm">     * Save event in Database</span>
<span class="cm">     * @return true if added else false</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">saveOrUpdate</span><span class="o">(</span><span class="n">MyEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Long</span> <span class="n">eid</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">eid</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">MyEvent</span><span class="o">.</span><span class="na">findLong</span><span class="o">.</span><span class="na">byId</span><span class="o">(</span><span class="n">eid</span><span class="o">)==</span><span class="kc">null</span><span class="o">)</span> <span class="o">{</span> 
                <span class="n">event</span><span class="o">.</span><span class="na">save</span><span class="o">();</span>
                <span class="n">counter</span><span class="o">++;</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;[&quot;</span> <span class="o">+</span> <span class="n">counter</span> <span class="o">+</span> <span class="s">&quot;] &quot;</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="na">eid</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="na">name</span><span class="o">);</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>printProgBar(counter/600);</p></div></div><div class="code"><div class="wrapper">                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span> 
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Input venueID</span>
<span class="cm">     * @return location</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span> <span class="nf">venue_location</span><span class="o">(</span><span class="n">String</span> <span class="n">venueID</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FacebookClient</span> <span class="n">facebookClient</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultFacebookClient</span><span class="o">(</span><span class="n">APP_ACCESS_TOKEN</span><span class="o">);</span>
        <span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">facebookClient</span><span class="o">.</span><span class="na">fetchObject</span><span class="o">(</span> <span class="n">venueID</span><span class="o">,</span> <span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span> <span class="n">location</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getJsonObject</span><span class="o">(</span><span class="s">&quot;location&quot;</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">location</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * input event</span>
<span class="cm">     * Filter events based on some fixed blocked venues and organizations</span>
<span class="cm">     * Also Filter events based on their city</span>
<span class="cm">     * @return true if event is not filtered else false</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">filter_event</span><span class="o">(</span><span class="n">MyEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">JSONObject</span> <span class="n">venue</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">venue_id</span><span class="o">,</span> <span class="n">venue_street</span><span class="o">,</span> <span class="n">venue_city</span><span class="o">,</span> <span class="n">venue_state</span><span class="o">,</span> <span class="n">venue_country</span><span class="o">,</span> <span class="n">venue_zip</span><span class="o">,</span> <span class="n">venue_longitude</span><span class="o">,</span> <span class="n">venue_latitude</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">location_id</span><span class="o">,</span> <span class="n">location_street</span><span class="o">,</span> <span class="n">location_city</span><span class="o">,</span> <span class="n">location_state</span><span class="o">,</span> <span class="n">location_country</span><span class="o">,</span> <span class="n">location_zip</span><span class="o">,</span> <span class="n">location_longitude</span><span class="o">,</span> <span class="n">location_latitude</span><span class="o">;</span>

        <span class="n">venue_street</span> <span class="o">=</span> <span class="n">venue_city</span> <span class="o">=</span> <span class="n">venue_state</span> <span class="o">=</span> <span class="n">venue_country</span> <span class="o">=</span> <span class="n">venue_zip</span> <span class="o">=</span> <span class="n">venue_latitude</span> <span class="o">=</span> <span class="n">venue_longitude</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="n">location_street</span> <span class="o">=</span> <span class="n">location_city</span> <span class="o">=</span> <span class="n">location_state</span> <span class="o">=</span> <span class="n">location_country</span> <span class="o">=</span> <span class="n">location_zip</span> <span class="o">=</span> <span class="n">location_latitude</span> <span class="o">=</span> <span class="n">location_longitude</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">((</span><span class="n">event</span><span class="o">.</span><span class="na">description</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="s">&quot;eventful.com&quot;</span><span class="o">))</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">{</span>

            <span class="k">if</span> <span class="o">(</span> <span class="o">((</span><span class="n">event</span><span class="o">.</span><span class="na">venue</span><span class="o">).</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> <span class="o">||</span> <span class="o">((</span><span class="n">event</span><span class="o">.</span><span class="na">venue</span><span class="o">).</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">||</span> <span class="o">((</span><span class="n">event</span><span class="o">.</span><span class="na">venue</span><span class="o">).</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;[]&quot;</span><span class="o">)))</span> <span class="o">{</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>System.out.println(event.toJSONString());</p></div></div><div class="code"><div class="wrapper">                <span class="n">venue</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="c1">// find some sort of filter for events with no venue?</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="n">venue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">venue</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="n">venue_id</span> <span class="o">=</span> <span class="n">venue</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">venue</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

            <span class="kt">boolean</span> <span class="n">blocked_venue</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">BLOCKED_VENUES</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">venue_id</span><span class="o">);</span>
            <span class="kt">boolean</span> <span class="n">blocked_organization</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">BLOCKED_ORGANIZATIONS</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">creator</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">blocked_venue</span> <span class="o">||</span> <span class="n">blocked_organization</span><span class="o">)</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>

            <span class="n">venue_street</span> <span class="o">=</span> <span class="n">venue</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;street&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">venue</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;street&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
            <span class="n">venue_city</span> <span class="o">=</span> <span class="n">venue</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;city&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">venue</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;city&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
            <span class="n">venue_state</span> <span class="o">=</span> <span class="n">venue</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;state&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">venue</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;state&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
            <span class="n">venue_country</span> <span class="o">=</span> <span class="n">venue</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;country&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">venue</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;country&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
            <span class="n">venue_zip</span> <span class="o">=</span> <span class="n">venue</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;zip&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">venue</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;zip&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
            <span class="n">venue_longitude</span> <span class="o">=</span> <span class="n">venue</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;latitude&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">venue</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;latitude&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
            <span class="n">venue_latitude</span> <span class="o">=</span> <span class="n">venue</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;longitude&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">venue</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;longitude&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
            
            <span class="k">if</span> <span class="o">(!</span><span class="n">venue_id</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span> <span class="n">location</span> <span class="o">=</span> <span class="n">venue_location</span><span class="o">(</span><span class="n">venue_id</span><span class="o">);</span>
                <span class="n">location_street</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;street&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">location</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;street&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
                <span class="n">location_city</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;city&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">location</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;city&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
                <span class="n">location_state</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;state&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">location</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;state&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
                <span class="n">location_country</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;country&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">location</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;country&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
                <span class="n">location_zip</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;zip&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">location</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;zip&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
                <span class="n">location_latitude</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;latitude&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">location</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;latitude&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
                <span class="n">location_longitude</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">&quot;longitude&quot;</span><span class="o">)</span> <span class="o">?</span> <span class="n">location</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;longitude&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="n">String</span> <span class="n">street</span> <span class="o">=</span> <span class="o">(!</span><span class="n">venue_street</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> <span class="o">?</span> <span class="n">venue_street</span> <span class="o">:</span> <span class="n">location_street</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">city</span> <span class="o">=</span> <span class="o">(!</span><span class="n">venue_city</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> <span class="o">?</span> <span class="n">venue_city</span> <span class="o">:</span> <span class="n">location_city</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">state</span> <span class="o">=</span> <span class="o">(!</span><span class="n">venue_state</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> <span class="o">?</span> <span class="n">venue_state</span> <span class="o">:</span> <span class="n">location_state</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">country</span> <span class="o">=</span> <span class="o">(!</span><span class="n">venue_country</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> <span class="o">?</span> <span class="n">venue_country</span> <span class="o">:</span> <span class="n">location_country</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">zip</span> <span class="o">=</span> <span class="o">(!</span><span class="n">venue_zip</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> <span class="o">?</span> <span class="n">venue_zip</span> <span class="o">:</span> <span class="n">location_zip</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">latitude</span> <span class="o">=</span> <span class="o">(!</span><span class="n">venue_longitude</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> <span class="o">?</span> <span class="n">venue_longitude</span> <span class="o">:</span> <span class="n">location_country</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">longitude</span> <span class="o">=</span> <span class="o">(!</span><span class="n">venue_latitude</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> <span class="o">?</span> <span class="n">venue_latitude</span> <span class="o">:</span> <span class="n">location_country</span><span class="o">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>TODO: check to makesure country and state are not blank before returning false
if (!country.equalsIgnoreCase("United States")) return false;
if (!state.equalsIgnoreCase("Illinois")) return false;</p></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>if(latitude,longitude is less than 1500 meters from center of NU) return true;</p></div></div><div class="code"><div class="wrapper">            <span class="k">if</span> <span class="o">(</span><span class="n">city</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">&quot;evanston&quot;</span><span class="o">))</span> <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Input events list</span>
<span class="cm">     * For all events in list which are in json create MyEvent object</span>
<span class="cm">     * Filter events</span>
<span class="cm">     * add filtered events which are MyEvent objects to eventlist</span>
<span class="cm">     * @return eventlist</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">MyEvent</span><span class="o">&gt;</span> <span class="nf">save_events</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span><span class="o">&gt;</span> <span class="n">events</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">MyEvent</span><span class="o">&gt;</span> <span class="n">eventList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">MyEvent</span><span class="o">&gt;();</span>

        <span class="k">for</span> <span class="o">(</span><span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span> <span class="n">event</span> <span class="o">:</span> <span class="n">events</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">MyEvent</span> <span class="n">newEvent</span> <span class="o">=</span> <span class="n">Utilities</span><span class="o">.</span><span class="na">createEvent</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">Utilities</span><span class="o">.</span><span class="na">filter_event</span><span class="o">(</span><span class="n">newEvent</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">Utilities</span><span class="o">.</span><span class="na">saveOrUpdate</span><span class="o">(</span><span class="n">newEvent</span><span class="o">))</span> <span class="o">{</span> 
                <span class="n">eventList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">newEvent</span><span class="o">);</span> 
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">eventList</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Input events array</span>
<span class="cm">     * For all events in array convert them to jsonObject</span>
<span class="cm">     * For all events in list which are in json create MyEvent object</span>
<span class="cm">     * Filter events</span>
<span class="cm">     * add filtered events which are MyEvent objects to eventlist</span>
<span class="cm">     * @return eventlist</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">MyEvent</span><span class="o">&gt;</span> <span class="nf">save_events</span><span class="o">(</span><span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonArray</span> <span class="n">events</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">MyEvent</span><span class="o">&gt;</span> <span class="n">eventList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">MyEvent</span><span class="o">&gt;();</span>

        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">events</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span> <span class="n">event</span> <span class="o">=</span> <span class="o">(</span><span class="n">com</span><span class="o">.</span><span class="na">restfb</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonObject</span><span class="o">)</span> <span class="n">events</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">MyEvent</span> <span class="n">newEvent</span> <span class="o">=</span> <span class="n">Utilities</span><span class="o">.</span><span class="na">createEvent</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">Utilities</span><span class="o">.</span><span class="na">filter_event</span><span class="o">(</span><span class="n">newEvent</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">Utilities</span><span class="o">.</span><span class="na">saveOrUpdate</span><span class="o">(</span><span class="n">newEvent</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">eventList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">newEvent</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">eventList</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Based on percent build a string</span>
<span class="cm">     * @param  percent percentage complete.</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printProgBar</span><span class="o">(</span><span class="kt">int</span> <span class="n">percent</span><span class="o">){</span>
        <span class="n">StringBuilder</span> <span class="n">bar</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">(</span><span class="s">&quot;[&quot;</span><span class="o">);</span>

        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="k">if</span><span class="o">(</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="o">(</span><span class="n">percent</span><span class="o">/</span><span class="mi">2</span><span class="o">)){</span>
                <span class="n">bar</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;=&quot;</span><span class="o">);</span>
            <span class="o">}</span><span class="k">else</span> <span class="k">if</span><span class="o">(</span> <span class="n">i</span> <span class="o">==</span> <span class="o">(</span><span class="n">percent</span><span class="o">/</span><span class="mi">2</span><span class="o">)){</span>
                <span class="n">bar</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;&gt;&quot;</span><span class="o">);</span>
            <span class="o">}</span><span class="k">else</span><span class="o">{</span>
                <span class="n">bar</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="n">bar</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;]   &quot;</span> <span class="o">+</span> <span class="n">percent</span> <span class="o">+</span> <span class="s">&quot;%     &quot;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;\r&quot;</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>


<span class="o">}</span></div></div></div></div></body></html>